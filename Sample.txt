Initial changes.

Modifed from forked branch.

Fixed issue #2